<div class="verify-container">
  <mat-card class="verify-card">
    <mat-card-header>
      <mat-card-title>ZSO Gantrisch Verwaltungssystem</mat-card-title>
      <mat-card-subtitle>E-Mail-Bestätigung</mat-card-subtitle>
    </mat-card-header>
    
    <mat-card-content>
      @if (isLoading()) {
        <div class="loading-state">
          <mat-spinner diameter="40"></mat-spinner>
          <p>Verifizierung wird durchgeführt...</p>
        </div>
      } @else if (isVerified()) {
        <div class="success-state">
          <mat-icon>check_circle</mat-icon>
          <div class="message">
            <h3>E-Mail erfolgreich bestätigt!</h3>
            <p>Ihre E-Mail-Adresse wurde erfolgreich verifiziert. Sie können sich jetzt anmelden.</p>
          </div>
        </div>
        <div class="action-buttons">
          <button mat-raised-button color="primary" (click)="goToLogin()">
            <mat-icon>login</mat-icon>
            Zur Anmeldung
          </button>
        </div>
      } @else if (errorMessage()) {
        <div class="error-state">
          <mat-icon>error</mat-icon>
          <div class="message">
            <h3>Fehler bei der Verifizierung</h3>
            <p>{{ errorMessage() }}</p>
            <p>Bitte versuchen Sie es erneut oder fordern Sie einen neuen Bestätigungslink an.</p>
          </div>
        </div>
        <div class="resend-section">
          <h4>Neuen Bestätigungslink anfordern</h4>
          <div class="email-input-group">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Ihre E-Mail-Adresse</mat-label>
              <input matInput type="email" [value]="email()" (input)="onEmailChange($event)" placeholder="beispiel@email.ch">
              <mat-icon matPrefix>email</mat-icon>
            </mat-form-field>
            <button mat-raised-button color="primary" [disabled]="!email()" (click)="resendVerification()">
              <mat-icon>send</mat-icon>
              Link zusenden
            </button>
          </div>
        </div>
        <div class="action-buttons">
          <button mat-stroked-button color="primary" (click)="goToLogin()">
            <mat-icon>login</mat-icon>
            Zur Anmeldung
          </button>
        </div>
      } @else {
        <div class="info-state">
          <mat-icon>info</mat-icon>
          <div class="message">
            <h3>E-Mail-Bestätigung erforderlich</h3>
            <p>
              Bitte öffnen Sie den Link in der E-Mail, die wir Ihnen gesendet haben,
              um Ihre E-Mail-Adresse zu bestätigen.
            </p>
            <p>Falls Sie keine E-Mail erhalten haben, prüfen Sie bitte Ihren Spam-Ordner.</p>
          </div>
        </div>
        <div class="resend-section">
          <h4>Neuen Bestätigungslink anfordern</h4>
          <div class="email-input-group">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Ihre E-Mail-Adresse</mat-label>
              <input matInput type="email" [value]="email()" (input)="onEmailChange($event)" placeholder="beispiel@email.ch">
              <mat-icon matPrefix>email</mat-icon>
            </mat-form-field>
            <button mat-raised-button color="primary" [disabled]="!email()" (click)="resendVerification()">
              <mat-icon>send</mat-icon>
              Link zusenden
            </button>
          </div>
        </div>
        <div class="action-buttons">
          <button mat-stroked-button color="primary" (click)="goToLogin()">
            <mat-icon>login</mat-icon>
            Zur Anmeldung
          </button>
        </div>
      }
    </mat-card-content>
    
    <mat-card-footer>
      <div class="footer-text">
        Bei Problemen wenden Sie sich bitte an den Administrator.
      </div>
    </mat-card-footer>
  </mat-card>
</div>
