<!-- src/app/modules/ausbildungen/ausbildungen-liste/ausbildungen-liste.component.html -->
<div class="ausbildungen-liste-container">
  <div class="header-section">
    <div class="title-section">
      <h1 class="page-title">Ausbildungen</h1>
    </div>

    <div class="action-section">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Suchen</mat-label>
        <input
          matInput
          [formControl]="searchControl"
          placeholder="Titel, Beschreibung, Jahr..."
        />
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="outline" class="filter-field">
        <mat-label>Typ</mat-label>
        <mat-select [formControl]="typFilter">
          <mat-option *ngFor="let option of typOptions" [value]="option.value">{{ option.label }}</mat-option>
        </mat-select>
      </mat-form-field>

      <button
        *ngIf="canEdit()"
        mat-raised-button
        color="primary"
        class="add-button"
        (click)="createAusbildung()"
      >
        <mat-icon>add</mat-icon>
        Neue Ausbildung
      </button>
    </div>
  </div>

  <div *ngIf="isLoading()" class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Daten werden geladen...</p>
  </div>

  <mat-card *ngIf="!isLoading()">
    <div class="table-container">
      <table mat-table [dataSource]="dataSource" matSort class="ausbildungen-table">
        <!-- Typ -->
        <ng-container matColumnDef="typ">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Typ</th>
          <td mat-cell *matCellDef="let ausbildung">
            <span class="typ-badge" [ngClass]="'typ-' + ausbildung.typ">
              {{ ausbildung.typ }}
            </span>
          </td>
        </ng-container>

        <!-- Titel -->
        <ng-container matColumnDef="titel">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Titel</th>
          <td mat-cell *matCellDef="let ausbildung">
            <div>
              <div class="ausbildung-titel">{{ ausbildung.titel }}</div>
              <div *ngIf="ausbildung.beschreibung" class="ausbildung-beschreibung">{{ ausbildung.beschreibung }}</div>
            </div>
          </td>
        </ng-container>

        <!-- Jahr -->
        <ng-container matColumnDef="jahr">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Jahr</th>
          <td mat-cell *matCellDef="let ausbildung">{{ ausbildung.jahr }}</td>
        </ng-container>

        <!-- Erforderlich -->
        <ng-container matColumnDef="erforderlich">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Erforderlich</th>
          <td mat-cell *matCellDef="let ausbildung">
            <mat-icon *ngIf="ausbildung.erforderlich" color="primary">check_circle</mat-icon>
            <mat-icon *ngIf="!ausbildung.erforderlich" color="warn">cancel</mat-icon>
          </td>
        </ng-container>

        <!-- Aktionen -->
        <ng-container matColumnDef="aktionen">
          <th mat-header-cell *matHeaderCellDef>Aktionen</th>
          <td mat-cell *matCellDef="let ausbildung">
            <div class="action-buttons">
              <!-- Anzeigen -->
              <button
                mat-icon-button
                color="primary"
                matTooltip="Details anzeigen"
                (click)="viewAusbildung(ausbildung); $event.stopPropagation()"
              >
                <mat-icon>visibility</mat-icon>
              </button>

              <!-- Teilnahme erfassen -->
              <button
                mat-icon-button
                color="primary"
                matTooltip="Teilnahmen erfassen"
                (click)="erfasseTeilnahme(ausbildung, $event)"
              >
                <mat-icon>assignment_turned_in</mat-icon>
              </button>

              <!-- Bearbeiten (nur mit entsprechender Berechtigung) -->
              <button
                *ngIf="canEdit()"
                mat-icon-button
                color="accent"
                matTooltip="Bearbeiten"
                (click)="editAusbildung(ausbildung, $event)"
              >
                <mat-icon>edit</mat-icon>
              </button>

              <!-- Löschen (nur mit entsprechender Berechtigung) -->
              <button
                *ngIf="canDelete()"
                mat-icon-button
                color="warn"
                matTooltip="Löschen"
                (click)="deleteAusbildung(ausbildung, $event)"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <!-- Tabellenzeilen -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          (click)="viewAusbildung(row)"
          class="ausbildung-row"
        ></tr>

        <!-- Leere Zeile wenn keine Daten -->
        <tr class="mat-row" *matNoDataRow>
          <td
            class="mat-cell empty-row"
            [attr.colspan]="displayedColumns.length"
          >
            <div class="no-data-message">
              <mat-icon>search_off</mat-icon>
              <span>Keine Ausbildungen gefunden</span>
            </div>
          </td>
        </tr>
      </table>
    </div>

    <!-- Paginierung -->
    <mat-paginator [pageSizeOptions]="[10, 25, 50, 100]" showFirstLastButtons>
    </mat-paginator>
  </mat-card>
</div>